<!DOCTYPE html>
<html lang="zxx" xmlns:th="http://www.w3.org/1999/xhtml">

<head>
    <meta charset="UTF-8">
    <meta name="description" content="Sona Template">
    <meta name="keywords" content="Sona, unica, creative, html">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Sona | Template</title>

    <!--  Bootstrap  -->
    <link rel="stylesheet" th:href="@{https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css}" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

    <link th:href="@{https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css}" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js" integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script>

    <!-- Google Font -->
    <link th:href="@{https://fonts.googleapis.com/css?family=Lora:400,700&display=swap}" rel="stylesheet">
    <link th:href="@{https://fonts.googleapis.com/css?family=Cabin:400,500,600,700&display=swap}" rel="stylesheet">

    <!-- Css Styles -->
    <link rel="stylesheet" href="/css/bootstrap.min.css" type="text/css">
    <link rel="stylesheet" href="/css/font-awesome.min.css" type="text/css">
    <link rel="stylesheet" href="/css/elegant-icons.css" type="text/css">
    <link rel="stylesheet" href="/css/flaticon.css" type="text/css">
    <link rel="stylesheet" href="/css/owl.carousel.min.css" type="text/css">
    <link rel="stylesheet" href="/css/nice-select.css" type="text/css">
    <link rel="stylesheet" href="/css/jquery-ui.min.css" type="text/css">
    <link rel="stylesheet" href="/css/magnific-popup.css" type="text/css">
    <link rel="stylesheet" href="/css/slicknav.min.css" type="text/css">
    <link rel="stylesheet" href="/css/style.css" type="text/css">
            <!-- Doesn't work TODO-->
    <th:block th:insert="~{blocks/links :: links}"></th:block>
</head>

<body>
<div th:insert="~{blocks/header :: header}"></div>
<div th:insert="~{blocks/modal :: modal}"></div>
    <!-- Breadcrumb Section Begin -->
    <div class="breadcrumb-section">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <div class="breadcrumb-text">
                        <h2>Помещение</h2>
                        <div class="bt-option">
                            <a href="./index.html">На главную</a>
                            <span>Домашняя страница</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Breadcrumb Section End -->

    <!-- Room Details Section Begin -->
    <section class="room-details-section spad">
        <div class="container">
            <div class="row">

                <th:block th:insert="~{${'objects/'+room.engName}:: ${room.engName}}"/>

                <div class="col-lg-4">
                    <div class="booking-form">
                        <h3>Бронирование</h3>
                        <form th:action="@{/rooms/{name}(name=${room.engName})}" th:object="${booking}" method="post" >
                            <div class="check-date">
                                <label for="date-in">Дата:</label>
                                <input type="text" class="date-input" id="date-in" required="required" onkeydown="return false;" autocomplete="off">
                                <input th:field="*{date}" type="text"id="alt-date" required="required" hidden="hidden">
                                <i class="icon_calendar"></i>
                                <div class="alert alert-danger" th:if="${#fields.hasErrors('date')}" th:errors="*{date}"></div>
                            </div>
                            <div class="check-date">
                                <label for="time-start">Начало:</label>
                                <input th:field="*{timeStart}" type="text" class="date-input" id="time-start" required="required">
                                <i class="icon_calendar"></i>
                            </div>
                            <div class="check-date">
                                <label for="time-end">Конец:</label>
                                <input th:field="*{timeEnd}" type="text" class="date-input" id="time-end" required="required">
                                <i class="icon_calendar"></i>
                                <div class="alert alert-danger" th:if="${#fields.hasErrors('timeEnd')}" th:errors="*{timeEnd}"></div>
                            </div>
                            <div class="check-date">
                                <input th:field=*{place} th:value="${room}" type="text" id="room" hidden="hidden" readonly>
                                <div class="alert alert-danger" th:if="${#fields.hasErrors('place') && !#fields.hasErrors('timeEnd')}">К сожалению данное помещение занято в это время
                                    <!-- /room/{room_id}?free_dates=true -->
                                    <a href="#">посмотреть свободные даты </a>
                                    или
                                    <!-- /rooms?free_rooms=true -->
                                    <a th:href="@{/rooms?free_rooms=true}"> посмотреть свободные помещения на это время</a>
                                </div>
                            </div>
                            <!-- /person_details -->
                            <button type="submit">Продолжить</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- Room Details Section End -->

    <div th:insert="~{blocks/footer :: footer}"></div>

    <!-- Js Plugins -->
    <script th:src="@{/js/jquery-3.3.1.min.js}"></script>
    <script th:src="@{/js/bootstrap.min.js}"></script>
    <script th:src="@{/js/jquery.magnific-popup.min.js}"></script>
    <script th:src="@{/js/jquery.nice-select.min.js}"></script>
    <script th:src="@{/js/jquery-ui.min.js}"></script>
    <script th:src="@{/js/jquery.slicknav.js}"></script>
    <script th:src="@{/js/owl.carousel.min.js}"></script>
    <script th:src="@{/js/main.js}"></script>
    <script th:src="@{/js/jquery-ui-timepicker-addon.js}"></script>
    <script th:src="@{/js/jquery-ui-timepicker-addon.min.js}"></script>

    <script src="https://api-maps.yandex.ru/2.0-stable/?apikey=58a2c036-d3dc-4114-9bd3-1f7483845947&load=package.standard&lang=ru-RU" type="text/javascript"></script>

    <script th:inline="javascript">
        ymaps.ready(init);
        var myMap,
            myPlacemark;
        function init(){
            let lat = /*[[${room.lat}]]*/;
            let lon = /*[[${room.lon}]]*/;
            //44.597365, 33.519790
            console.log(lat+" "+lon)
            myMap = new ymaps.Map ("map", {
                center: [lat, lon],
                zoom: 17,
                behaviors: ['ruler', 'scrollZoom'],
                geoObjectDraggable: true
            });
            myPlacemark = new ymaps.Placemark([lat, lon], {
            },{
                // Опции.
                // Необходимо указать данный тип макета.
                iconLayout: 'default#image',
                // Своё изображение иконки метки.
                iconImageHref: '/icon/wing.png',
                iconImageSize: [60, 70],
            });

            myMap.geoObjects.add(myPlacemark);
            myMap.controls.add(new ymaps.control.MiniMap({type:'yandex#hybrid'},{zoomOffset: 5}));
            myMap.behaviors.enable(['drag', 'rightMouseButtonMagnifier'])
        }
    </script>
</body>

</html>